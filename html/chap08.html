<?xml version="1.0"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>How to Think Like a Computer Scientist: 8. Case Study: Catch</title><link href="stylesheet.css" type="text/css" rel="stylesheet" /></head><body bgcolor="white"><h1 class="title">8. Case Study: Catch</h1><div class="toc"><ol><li><a href="#auto0">Getting started</a></li><li><a href="#auto1">Using while to move a ball</a></li><li><a href="#auto2">Varying the pitches</a></li><li><a href="#auto3">Making the ball bounce</a></li><li><a href="#auto4">The break statement</a></li><li><a href="#auto5">Responding to the keyboard</a></li><li><a href="#auto6">Checking for collisions</a></li><li><a href="#auto7">Putting the pieces together</a></li><li><a href="#auto8">Displaying text</a></li><li><a href="#auto9">Abstraction</a></li><li><a href="#auto10">Glossary</a></li><li><a href="#auto11">Exercises</a></li><li><a href="#auto12">Project: pong.py</a></li></ol></div><div class="content"><span></span><h2>8.1 Getting started<a name="auto0"></a></h2><p>In our first case study we will build a small video game using the
facilities in the GASP package.  The game will shoot a ball across a window
from left to right and you will manipulate a <q>mitt</q> at the right side of
the window to catch it.</p><h2>8.2 Using <code>while</code> to move a ball<a name="auto1"></a></h2><p><code>while</code> statements can be used with <code>gasp</code> to add
motion to a program.  The following program moves a black ball across an
800 x 600 pixel graphics canvas.  Add this to a file named
<code>pitch.py</code>:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">begin_graphics</span>(<span class="py-src-number">800</span>, <span class="py-src-number">600</span>, <span class="py-src-variable">title</span>=<span class="py-src-string">&quot;Catch&quot;</span>, <span class="py-src-variable">background</span>=<span class="py-src-variable">color</span>.<span class="py-src-variable">yellow</span>)

<span class="py-src-variable">ball_x</span> = <span class="py-src-number">10</span>
<span class="py-src-variable">ball_y</span> = <span class="py-src-number">300</span>
<span class="py-src-variable">ball</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>), <span class="py-src-number">10</span>, <span class="py-src-variable">filled</span>=<span class="py-src-variable">True</span>)
<span class="py-src-variable">dx</span> = <span class="py-src-number">4</span>
<span class="py-src-variable">dy</span> = <span class="py-src-number">1</span>

<span class="py-src-keyword">while</span> <span class="py-src-variable">ball_x</span> &lt; <span class="py-src-number">810</span>:
    <span class="py-src-variable">ball_x</span> += <span class="py-src-variable">dx</span>
    <span class="py-src-variable">ball_y</span> += <span class="py-src-variable">dy</span>
    <span class="py-src-variable">move_to</span>(<span class="py-src-variable">ball</span>, (<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>))
    <span class="py-src-variable">sleep</span>(<span class="py-src-number">0.01</span>)

<span class="py-src-variable">end_graphics</span>()
</pre><p>As the ball moves across the screen, you will see a graphics window that
looks like this:</p><img src="illustrations/gasp03.png" /><p>Trace the first few iterations of this program to be sure you see what is
happening to the variables <code>x</code> and <code>y</code>.</p><p>Some new things to learn about GASP from this example:</p><ul><li><code>begin_graphics</code> can take arguments for width, height,
  title, and background color of the graphics canvas.</li><li>Adding <code>filled=True</code> to <code>Circle(...)</code> makes
  the resulting circle solid.</li><li><code>ball = Circle</code> stores the circle (we will talk later
  about what a circle actually is) in a variable named <code>ball</code>
  so that it can be referenced later.</li><li>The <code>move_to</code> function in GASP allows a programmer to
  pass in a shape (the ball in this case) and a location, and moves the
  shape to that location.</li><li>The <code>sleep</code> function takes a time value in seconds as
  an argument and pauses execution of the program for that length of time.
  In general computers do things much to fast to allow you to interact with
  them.  We can slow things down by making the computer sleep a bit at the
  right place.</li></ul><h2>8.3 Varying the pitches<a name="auto2"></a></h2><a name="index01"></a><a name="index02"></a><p>To make our game more interesting, we want to be able to vary the speed and
direction of the ball.  GASP has a function,
<code>random_between(low, high)</code>, that returns a <b>random</b> integer
between <code>low</code> and <code>high</code>.  To see how this works,
run the following program:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">i</span> = <span class="py-src-number">0</span>
<span class="py-src-keyword">while</span> <span class="py-src-variable">i</span> &lt; <span class="py-src-number">10</span>:
    <span class="py-src-keyword">print</span> <span class="py-src-variable">random_between</span>(-<span class="py-src-number">5</span>, <span class="py-src-number">5</span>)
    <span class="py-src-variable">i</span> += <span class="py-src-number">1</span>
</pre><p>Each time the function is called a more or less random integer is chosen
between -5 and 5.  When we ran this program we got:</p><pre class="shell">
-2
-1
-4
1
-2
3
-5
-3
4
-5
</pre><p>You will probably get a different sequence of numbers.</p><p>Let's use <code>random_between</code> to vary the direction of the ball.
Replace the line in <code>pitch.py</code> that assigns <code>1</code>
to <code>y</code>:</p><pre class="python">
<span class="py-src-variable">dy</span> = <span class="py-src-number">1</span>
</pre><p>with an assignment to a random number between -4 and 4:</p><pre class="python">
<span class="py-src-variable">dy</span> = <span class="py-src-variable">random_between</span>(-<span class="py-src-number">4</span>, <span class="py-src-number">4</span>)
</pre><h2>8.4 Making the ball <q>bounce</q><a name="auto3"></a></h2><p>Running this new version of the program, you will notice that ball
frequently goes off either the top or bottom edges of the screen before it
completes its journey.  To prevent this, let's make the ball <q>bounce</q>
off the edges by changing the sign of <code>dy</code> and sending the
ball back in the opposite verticle direction.</p><p>Add the following as the first line of the body of the while loop in
<code>pitch.py</code>:</p><pre class="python">
<span class="py-src-keyword">if</span> <span class="py-src-variable">ball_y</span> &gt;= <span class="py-src-number">590</span> <span class="py-src-keyword">or</span> <span class="py-src-variable">ball_y</span> &lt;= <span class="py-src-number">10</span>:
    <span class="py-src-variable">dy</span> *= -<span class="py-src-number">1</span>
</pre><p>Run the program several times to see how it behaves.</p><h2>8.5 The <code>break</code> statement<a name="auto4"></a></h2><a name="index03"></a><a name="index04"></a><p>The <b>break</b> statement is used to immediately leave the body of a loop.  
The following program impliments simple simple guessing game:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">number</span> = <span class="py-src-variable">random_between</span>(<span class="py-src-number">1</span>, <span class="py-src-number">1000</span>)
<span class="py-src-variable">guesses</span> = <span class="py-src-number">1</span>
<span class="py-src-variable">guess</span> = <span class="py-src-variable">input</span>(<span class="py-src-string">&quot;Guess the number between 1 and 1000: &quot;</span>)

<span class="py-src-keyword">while</span> <span class="py-src-variable">guess</span> != <span class="py-src-variable">number</span>:
    <span class="py-src-keyword">if</span> <span class="py-src-variable">guess</span> &gt; <span class="py-src-variable">number</span>:
        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;Too high!&quot;</span>
    <span class="py-src-keyword">else</span>:
        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;Too low!&quot;</span>
    <span class="py-src-variable">guess</span> = <span class="py-src-variable">input</span>(<span class="py-src-string">&quot;Guess the number between 1 and 1000: &quot;</span>)
    <span class="py-src-variable">guesses</span> += <span class="py-src-number">1</span>

<span class="py-src-keyword">print</span> <span class="py-src-string">&quot;\n\nCongratulations, you got it in %d guesses!\n\n&quot;</span> % <span class="py-src-variable">guesses</span>
</pre><p>Using a <code>break</code> statement, we can rewrite this program to
eliminate the duplication of the <code>input</code> statement:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">number</span> = <span class="py-src-variable">random_between</span>(<span class="py-src-number">1</span>, <span class="py-src-number">1000</span>)
<span class="py-src-variable">guesses</span> = <span class="py-src-number">0</span>

<span class="py-src-keyword">while</span> <span class="py-src-variable">True</span>:
    <span class="py-src-variable">guess</span> = <span class="py-src-variable">input</span>(<span class="py-src-string">&quot;Guess the number between 1 and 1000: &quot;</span>)
    <span class="py-src-variable">guesses</span> += <span class="py-src-number">1</span>
    <span class="py-src-keyword">if</span> <span class="py-src-variable">guess</span> &gt; <span class="py-src-variable">number</span>:
        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;Too high!&quot;</span>
    <span class="py-src-keyword">elif</span> <span class="py-src-variable">guess</span> &lt; <span class="py-src-variable">number</span>:
        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;Too low!&quot;</span>
    <span class="py-src-keyword">else</span>:
        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;\n\nCongratulations, you got it in %d guesses!\n\n&quot;</span> % <span class="py-src-variable">guesses</span>
        <span class="py-src-keyword">break</span>
</pre><p>This program makes use of the mathematical law of <b>trichotomy</b> (given
real numbers a and b, a &gt; b, a &lt; b, or a = b).  While both versions of
the program are 15 lines long, it could be argued that the logic in the second
version is clearer.</p><p>Put this program in a file named <code>guess.py</code>.</p><h2>8.6 Responding to the keyboard<a name="auto5"></a></h2><p>The following program creates a circle (or <q>mitt</q>) which responds to
keyboard input.  Pressing the <code>j</code> or <code>k</code> keys moves the
mitt up and down, respectively.  Add this to a file named
<code>mitt.py</code>:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">begin_graphics</span>(<span class="py-src-number">800</span>, <span class="py-src-number">600</span>, <span class="py-src-variable">title</span>=<span class="py-src-string">&quot;Catch&quot;</span>, <span class="py-src-variable">background</span>=<span class="py-src-variable">color</span>.<span class="py-src-variable">yellow</span>)

<span class="py-src-variable">mitt_x</span> = <span class="py-src-number">780</span>
<span class="py-src-variable">mitt_y</span> = <span class="py-src-number">300</span>
<span class="py-src-variable">mitt</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>), <span class="py-src-number">20</span>)

<span class="py-src-keyword">while</span> <span class="py-src-variable">True</span>:
    <span class="py-src-keyword">if</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'k'</span>) <span class="py-src-keyword">and</span> <span class="py-src-variable">mitt_y</span> &lt;= <span class="py-src-number">580</span>:
        <span class="py-src-variable">mitt_y</span> += <span class="py-src-number">5</span>
    <span class="py-src-keyword">elif</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'j'</span>) <span class="py-src-keyword">and</span> <span class="py-src-variable">mitt_y</span> &gt;= <span class="py-src-number">20</span>:
        <span class="py-src-variable">mitt_y</span> -= <span class="py-src-number">5</span>

    <span class="py-src-keyword">if</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'escape'</span>):
        <span class="py-src-keyword">break</span>

    <span class="py-src-variable">move_to</span>(<span class="py-src-variable">mitt</span>, (<span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>))
    <span class="py-src-variable">sleep</span>(<span class="py-src-number">0.01</span>)

<span class="py-src-variable">end_graphics</span>()
</pre><p>Run <code>mitt.py</code>, pressing <code>j</code> and <code>k</code> to
move up and down the screen.</p><h2>8.7 Checking for collisions<a name="auto6"></a></h2><p>The following program moves two balls toward each other from opposite sides
of the screen.  When they <q>collide</q>, both balls disappear and the program
ends:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-keyword">def</span> <span class="py-src-identifier">distance</span>(<span class="py-src-parameter">x1</span>, <span class="py-src-parameter">y1</span>, <span class="py-src-parameter">x2</span>, <span class="py-src-parameter">y2</span>):
    <span class="py-src-keyword">return</span> ((<span class="py-src-variable">x2</span> - <span class="py-src-variable">x1</span>)**<span class="py-src-number">2</span> + (<span class="py-src-variable">y2</span> - <span class="py-src-variable">y1</span>)**<span class="py-src-number">2</span>)**<span class="py-src-number">0.5</span>

<span class="py-src-variable">begin_graphics</span>(<span class="py-src-number">800</span>, <span class="py-src-number">600</span>, <span class="py-src-variable">title</span>=<span class="py-src-string">&quot;Catch&quot;</span>, <span class="py-src-variable">background</span>=<span class="py-src-variable">color</span>.<span class="py-src-variable">yellow</span>)

<span class="py-src-variable">ball1_x</span> = <span class="py-src-number">10</span>
<span class="py-src-variable">ball1_y</span> = <span class="py-src-number">300</span>
<span class="py-src-variable">ball1</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">ball1_x</span>, <span class="py-src-variable">ball1_y</span>), <span class="py-src-number">10</span>, <span class="py-src-variable">filled</span>=<span class="py-src-variable">True</span>)
<span class="py-src-variable">ball1_dx</span> = <span class="py-src-number">4</span>

<span class="py-src-variable">ball2_x</span> = <span class="py-src-number">790</span>
<span class="py-src-variable">ball2_y</span> = <span class="py-src-number">300</span>
<span class="py-src-variable">ball2</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">ball2_x</span>, <span class="py-src-variable">ball2_y</span>), <span class="py-src-number">10</span>)
<span class="py-src-variable">ball2_dx</span> = -<span class="py-src-number">4</span>

<span class="py-src-keyword">while</span> <span class="py-src-variable">ball1_x</span> &lt; <span class="py-src-number">810</span>:
    <span class="py-src-variable">ball1_x</span> += <span class="py-src-variable">ball1_dx</span>
    <span class="py-src-variable">ball2_x</span> += <span class="py-src-variable">ball2_dx</span>
    <span class="py-src-variable">move_to</span>(<span class="py-src-variable">ball1</span>, (<span class="py-src-variable">ball1_x</span>, <span class="py-src-variable">ball1_y</span>))
    <span class="py-src-variable">move_to</span>(<span class="py-src-variable">ball2</span>, (<span class="py-src-variable">ball2_x</span>, <span class="py-src-variable">ball2_y</span>))
    <span class="py-src-keyword">if</span> <span class="py-src-variable">distance</span>(<span class="py-src-variable">ball1_x</span>, <span class="py-src-variable">ball1_y</span>, <span class="py-src-variable">ball2_x</span>, <span class="py-src-variable">ball2_y</span>) &lt;= <span class="py-src-number">20</span>:
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">ball1</span>)
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">ball2</span>)
        <span class="py-src-keyword">break</span>
    <span class="py-src-variable">sleep</span>(<span class="py-src-number">0.01</span>)

<span class="py-src-variable">sleep</span>(<span class="py-src-number">1</span>)
<span class="py-src-variable">end_graphics</span>()
</pre><p>Put this program in a file named <code>collide.py</code> and run it.</p><h2>8.8 Putting the pieces together<a name="auto7"></a></h2><p>In order to combine the moving ball, moving mitt, and collision detection,
we need a single <code>while</code> loop that does each of these things in
turn:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-keyword">def</span> <span class="py-src-identifier">distance</span>(<span class="py-src-parameter">x1</span>, <span class="py-src-parameter">y1</span>, <span class="py-src-parameter">x2</span>, <span class="py-src-parameter">y2</span>):
        <span class="py-src-keyword">return</span> ((<span class="py-src-variable">x2</span> - <span class="py-src-variable">x1</span>)**<span class="py-src-number">2</span> + (<span class="py-src-variable">y2</span> - <span class="py-src-variable">y1</span>)**<span class="py-src-number">2</span>)**<span class="py-src-number">0.5</span>

<span class="py-src-variable">begin_graphics</span>(<span class="py-src-number">800</span>, <span class="py-src-number">600</span>, <span class="py-src-variable">title</span>=<span class="py-src-string">&quot;Catch&quot;</span>, <span class="py-src-variable">background</span>=<span class="py-src-variable">color</span>.<span class="py-src-variable">yellow</span>)

<span class="py-src-variable">ball_x</span> = <span class="py-src-number">10</span>
<span class="py-src-variable">ball_y</span> = <span class="py-src-number">300</span>
<span class="py-src-variable">ball</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>), <span class="py-src-number">10</span>, <span class="py-src-variable">filled</span>=<span class="py-src-variable">True</span>)
<span class="py-src-variable">dx</span> = <span class="py-src-number">4</span>
<span class="py-src-variable">dy</span> = <span class="py-src-variable">random_between</span>(-<span class="py-src-number">4</span>, <span class="py-src-number">4</span>) 

<span class="py-src-variable">mitt_x</span> = <span class="py-src-number">780</span>
<span class="py-src-variable">mitt_y</span> = <span class="py-src-number">300</span>
<span class="py-src-variable">mitt</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>), <span class="py-src-number">20</span>)

<span class="py-src-keyword">while</span> <span class="py-src-variable">True</span>:
    <span class="py-src-comment"># move the ball
</span>    <span class="py-src-keyword">if</span> <span class="py-src-variable">ball_y</span> &gt;= <span class="py-src-number">590</span> <span class="py-src-keyword">or</span> <span class="py-src-variable">ball_y</span> &lt;= <span class="py-src-number">10</span>:
        <span class="py-src-variable">dy</span> *= -<span class="py-src-number">1</span>
    <span class="py-src-variable">ball_x</span> += <span class="py-src-variable">dx</span>
    <span class="py-src-keyword">if</span> <span class="py-src-variable">ball_x</span> &gt; <span class="py-src-number">810</span>:             <span class="py-src-comment"># the ball has gone off the screen</span>
        <span class="py-src-keyword">break</span>
    <span class="py-src-variable">ball_y</span> += <span class="py-src-variable">dy</span>
    <span class="py-src-variable">move_to</span>(<span class="py-src-variable">ball</span>, (<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>))

    <span class="py-src-comment"># check on the mitt
</span>    <span class="py-src-keyword">if</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'k'</span>) <span class="py-src-keyword">and</span> <span class="py-src-variable">mitt_y</span> &lt;= <span class="py-src-number">580</span>:
        <span class="py-src-variable">mitt_y</span> += <span class="py-src-number">5</span>
    <span class="py-src-keyword">elif</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'j'</span>) <span class="py-src-keyword">and</span> <span class="py-src-variable">mitt_y</span> &gt;= <span class="py-src-number">20</span>:
        <span class="py-src-variable">mitt_y</span> -= <span class="py-src-number">5</span>

    <span class="py-src-keyword">if</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'escape'</span>):
        <span class="py-src-keyword">break</span>

    <span class="py-src-variable">move_to</span>(<span class="py-src-variable">mitt</span>, (<span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>))

    <span class="py-src-keyword">if</span> <span class="py-src-variable">distance</span>(<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>, <span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>) &lt;= <span class="py-src-number">30</span>:  <span class="py-src-comment"># ball is caught</span>
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">ball</span>)
        <span class="py-src-keyword">break</span>

    <span class="py-src-variable">sleep</span>(<span class="py-src-number">0.01</span>)

<span class="py-src-variable">end_graphics</span>()
</pre><p>Put this program in a file named <code>catch.py</code> and run it several
times. Be sure to <q>catch</q> the ball on some runs and miss it on others.</p><h2>8.9 Displaying text<a name="auto8"></a></h2><p>This program displays scores for both a player and the computer on the
graphics screen.  It generates a random number of 0 or 1 (like flipping a coin)
and adds a point to the player if the value is 1 and to the computer if it is
not.  It then updates the display on the screen.</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">begin_graphics</span>(<span class="py-src-number">800</span>, <span class="py-src-number">600</span>, <span class="py-src-variable">title</span>=<span class="py-src-string">&quot;Catch&quot;</span>, <span class="py-src-variable">background</span>=<span class="py-src-variable">color</span>.<span class="py-src-variable">yellow</span>)

<span class="py-src-variable">player_score</span> = <span class="py-src-number">0</span>
<span class="py-src-variable">comp_score</span> = <span class="py-src-number">0</span>

<span class="py-src-variable">player</span> = <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Player: %d Points&quot;</span> % <span class="py-src-variable">player_score</span>, (<span class="py-src-number">10</span>, <span class="py-src-number">570</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">24</span>)
<span class="py-src-variable">computer</span> = <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Computer: %d Points&quot;</span> % <span class="py-src-variable">comp_score</span>, (<span class="py-src-number">640</span>, <span class="py-src-number">570</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">24</span>)

<span class="py-src-keyword">while</span> <span class="py-src-variable">player_score</span> &lt; <span class="py-src-number">5</span> <span class="py-src-keyword">and</span> <span class="py-src-variable">comp_score</span> &lt; <span class="py-src-number">5</span>:
    <span class="py-src-variable">sleep</span>(<span class="py-src-number">1</span>)
    <span class="py-src-variable">winner</span> = <span class="py-src-variable">random_between</span>(<span class="py-src-number">0</span>, <span class="py-src-number">1</span>)
    <span class="py-src-keyword">if</span> <span class="py-src-variable">winner</span>:
        <span class="py-src-variable">player_score</span> += <span class="py-src-number">1</span>
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">player</span>)
        <span class="py-src-variable">player</span> = <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Player: %d Points&quot;</span> % <span class="py-src-variable">player_score</span>, (<span class="py-src-number">10</span>, <span class="py-src-number">570</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">24</span>)
    <span class="py-src-keyword">else</span>:
        <span class="py-src-variable">comp_score</span> += <span class="py-src-number">1</span>
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">computer</span>)
        <span class="py-src-variable">computer</span> = <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Computer: %d Points&quot;</span> % <span class="py-src-variable">comp_score</span>, (<span class="py-src-number">640</span>, <span class="py-src-number">570</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">24</span>)

<span class="py-src-keyword">if</span> <span class="py-src-variable">player_score</span> == <span class="py-src-number">5</span>:
    <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Player Wins!&quot;</span>, (<span class="py-src-number">340</span>, <span class="py-src-number">290</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">32</span>)
<span class="py-src-keyword">else</span>:
    <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Computer Wins!&quot;</span>, (<span class="py-src-number">340</span>, <span class="py-src-number">290</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">32</span>)

<span class="py-src-variable">sleep</span>(<span class="py-src-number">4</span>)

<span class="py-src-variable">end_graphics</span>()
</pre><p>Put this program in a file named <code>scores.py</code> and run it.</p><p>We can now modify <code>catch.py</code> to diplay the winner.  Immediately
after the <code>if ball_x &gt; 810:</code> conditional, add the following:</p><pre class="python">
<span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Computer Wins!&quot;</span>, (<span class="py-src-number">340</span>, <span class="py-src-number">290</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">32</span>)
<span class="py-src-variable">sleep</span>(<span class="py-src-number">2</span>)
</pre><p>It is left as an excercise to display when the player wins.</p><h2>8.10 Abstraction<a name="auto9"></a></h2><a name="index05"></a><a name="index06"></a><p>Our program is getting a bit complex.  To make matters worse, we are about
to increase its complexity.  The next stage of development requires a
<b>nested loop</b>.  The outer loop will handle repeating rounds of play until
either the player or the computer reaches a winning score.  The inner loop will
be the one we already have, which plays a single round, moving the ball and
mitt, and determining if a catch or a miss has occured.</p><p>Research suggests there is are clear limits to our ability to process
cognitive tasks (see George A. Miller's 
<a href="http://psychclassics.yorku.ca/Miller">The Magical Number Seven, Plus
or Minus Two: Some Limits on our Capacity for Processing Information</a>).
The more complex a program becomes, the more difficult it is for even an
experienced programmer to develop and maintain.</p><p>To handle increasing complexity, we can wrap groups of related statements in
functions, using <b>abstraction</b> to hide program details.  This allows us to 
mentally treat a group of programming statements as a single concept, freeing
up mental <q>bandwidth</q> for further tasks.  The ability to use abstraction
is one of the most powerful ideas in computer programming.</p><p>Here is a completed version of <code>catch.py</code>:</p><pre class="python">
<span class="py-src-keyword">from</span> <span class="py-src-variable">gasp</span> <span class="py-src-keyword">import</span> *

<span class="py-src-variable">COMPUTER_WINS</span> = <span class="py-src-number">1</span>
<span class="py-src-variable">PLAYER_WINS</span> = <span class="py-src-number">0</span>
<span class="py-src-variable">QUIT</span> = -<span class="py-src-number">1</span>


<span class="py-src-keyword">def</span> <span class="py-src-identifier">distance</span>(<span class="py-src-parameter">x1</span>, <span class="py-src-parameter">y1</span>, <span class="py-src-parameter">x2</span>, <span class="py-src-parameter">y2</span>):
        <span class="py-src-keyword">return</span> ((<span class="py-src-variable">x2</span> - <span class="py-src-variable">x1</span>)**<span class="py-src-number">2</span> + (<span class="py-src-variable">y2</span> - <span class="py-src-variable">y1</span>)**<span class="py-src-number">2</span>)**<span class="py-src-number">0.5</span>


<span class="py-src-keyword">def</span> <span class="py-src-identifier">play_round</span>():
    <span class="py-src-variable">ball_x</span> = <span class="py-src-number">10</span>
    <span class="py-src-variable">ball_y</span> = <span class="py-src-variable">random_between</span>(<span class="py-src-number">20</span>, <span class="py-src-number">280</span>)
    <span class="py-src-variable">ball</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>), <span class="py-src-number">10</span>, <span class="py-src-variable">filled</span>=<span class="py-src-variable">True</span>)
    <span class="py-src-variable">dx</span> = <span class="py-src-number">4</span>
    <span class="py-src-variable">dy</span> = <span class="py-src-variable">random_between</span>(-<span class="py-src-number">5</span>, <span class="py-src-number">5</span>) 

    <span class="py-src-variable">mitt_x</span> = <span class="py-src-number">780</span>
    <span class="py-src-variable">mitt_y</span> = <span class="py-src-variable">random_between</span>(<span class="py-src-number">20</span>, <span class="py-src-number">280</span>)
    <span class="py-src-variable">mitt</span> = <span class="py-src-variable">Circle</span>((<span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>), <span class="py-src-number">20</span>)

    <span class="py-src-keyword">while</span> <span class="py-src-variable">True</span>:
        <span class="py-src-keyword">if</span> <span class="py-src-variable">ball_y</span> &gt;= <span class="py-src-number">590</span> <span class="py-src-keyword">or</span> <span class="py-src-variable">ball_y</span> &lt;= <span class="py-src-number">10</span>:
            <span class="py-src-variable">dy</span> *= -<span class="py-src-number">1</span>
        <span class="py-src-variable">ball_x</span> += <span class="py-src-variable">dx</span>
        <span class="py-src-variable">ball_y</span> += <span class="py-src-variable">dy</span>
        <span class="py-src-keyword">if</span> <span class="py-src-variable">ball_x</span> &gt;= <span class="py-src-number">810</span>:
            <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">ball</span>)
            <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">mitt</span>)
            <span class="py-src-keyword">return</span> <span class="py-src-variable">COMPUTER_WINS</span> 
        <span class="py-src-variable">move_to</span>(<span class="py-src-variable">ball</span>, (<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>))

        <span class="py-src-keyword">if</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'k'</span>) <span class="py-src-keyword">and</span> <span class="py-src-variable">mitt_y</span> &lt;= <span class="py-src-number">580</span>:
            <span class="py-src-variable">mitt_y</span> += <span class="py-src-number">5</span>
        <span class="py-src-keyword">elif</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'j'</span>) <span class="py-src-keyword">and</span> <span class="py-src-variable">mitt_y</span> &gt;= <span class="py-src-number">20</span>:
            <span class="py-src-variable">mitt_y</span> -= <span class="py-src-number">5</span>

        <span class="py-src-keyword">if</span> <span class="py-src-variable">key_pressed</span>(<span class="py-src-string">'escape'</span>):
            <span class="py-src-keyword">return</span> <span class="py-src-variable">QUIT</span>

        <span class="py-src-variable">move_to</span>(<span class="py-src-variable">mitt</span>, (<span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>))

        <span class="py-src-keyword">if</span> <span class="py-src-variable">distance</span>(<span class="py-src-variable">ball_x</span>, <span class="py-src-variable">ball_y</span>, <span class="py-src-variable">mitt_x</span>, <span class="py-src-variable">mitt_y</span>) &lt;= <span class="py-src-number">30</span>:
            <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">ball</span>)
            <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">mitt</span>)
            <span class="py-src-keyword">return</span> <span class="py-src-variable">PLAYER_WINS</span>

        <span class="py-src-variable">sleep</span>(<span class="py-src-number">0.005</span>)


<span class="py-src-keyword">def</span> <span class="py-src-identifier">play_game</span>():
    <span class="py-src-variable">player_score</span> = <span class="py-src-number">0</span>
    <span class="py-src-variable">comp_score</span> = <span class="py-src-number">0</span>

    <span class="py-src-keyword">while</span> <span class="py-src-variable">True</span>:
        <span class="py-src-variable">pmsg</span> = <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Player: %d Points&quot;</span> % <span class="py-src-variable">player_score</span>, (<span class="py-src-number">10</span>, <span class="py-src-number">570</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">24</span>)
        <span class="py-src-variable">cmsg</span> = <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Computer: %d Points&quot;</span> % <span class="py-src-variable">comp_score</span>, (<span class="py-src-number">640</span>, <span class="py-src-number">570</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">24</span>)
        <span class="py-src-variable">sleep</span>(<span class="py-src-number">3</span>)
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">pmsg</span>)
        <span class="py-src-variable">remove_from_screen</span>(<span class="py-src-variable">cmsg</span>)

        <span class="py-src-variable">result</span> = <span class="py-src-variable">play_round</span>()

        <span class="py-src-keyword">if</span> <span class="py-src-variable">result</span> == <span class="py-src-variable">PLAYER_WINS</span>:
            <span class="py-src-variable">player_score</span> += <span class="py-src-number">1</span>
        <span class="py-src-keyword">elif</span> <span class="py-src-variable">result</span> == <span class="py-src-variable">COMPUTER_WINS</span>:
            <span class="py-src-variable">comp_score</span> += <span class="py-src-number">1</span>
        <span class="py-src-keyword">else</span>:
            <span class="py-src-keyword">return</span> <span class="py-src-variable">QUIT</span> 

        <span class="py-src-keyword">if</span> <span class="py-src-variable">player_score</span> == <span class="py-src-number">5</span>:
            <span class="py-src-keyword">return</span> <span class="py-src-variable">PLAYER_WINS</span>
        <span class="py-src-keyword">elif</span> <span class="py-src-variable">comp_score</span> == <span class="py-src-number">5</span>:
            <span class="py-src-keyword">return</span> <span class="py-src-variable">COMPUTER_WINS</span> 


<span class="py-src-variable">begin_graphics</span>(<span class="py-src-number">800</span>, <span class="py-src-number">600</span>, <span class="py-src-variable">title</span>=<span class="py-src-string">&quot;Catch&quot;</span>, <span class="py-src-variable">background</span>=<span class="py-src-variable">color</span>.<span class="py-src-variable">yellow</span>)

<span class="py-src-variable">result</span> = <span class="py-src-variable">play_game</span>()

<span class="py-src-keyword">if</span> <span class="py-src-variable">result</span> == <span class="py-src-variable">PLAYER_WINS</span>:
    <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Player Wins!&quot;</span>, (<span class="py-src-number">340</span>, <span class="py-src-number">290</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">32</span>)
    <span class="py-src-variable">sleep</span>(<span class="py-src-number">4</span>)
<span class="py-src-keyword">elif</span> <span class="py-src-variable">result</span> == <span class="py-src-variable">COMPUTER_WINS</span>:
    <span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Computer Wins!&quot;</span>, (<span class="py-src-number">340</span>, <span class="py-src-number">290</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">32</span>)
    <span class="py-src-variable">sleep</span>(<span class="py-src-number">4</span>)

<span class="py-src-variable">end_graphics</span>()
</pre><p>Some new things to learn from this example:</p><a name="index07"></a><ul><li>Following good organizational practices makes programs easier to read.
  Use the following organization in your programs:
  <ul><li>imports</li><li>global constants</li><li>function definitions</li><li>main body of the program</li></ul></li><li>Symbolic <b>constants</b> like <code>COMPUTER_WINS</code>,
  <code>PLAYER_WINS</code>, and <code>QUIT</code> can be used to enhance
  readability of the program.  It is customary to name constants with
  all capital letters.  In Python it is up to the programmer to never
  assign a new value to a <q>constant</q>, since the language does not
  provide an easy way to enforce this (many other programming languages do).
  </li><li>We took the version of the program developed in section 8.8 and wrapped
  it in a function named <code>play_round()</code>.  <code>play_round</code>
  makes use of the constants defined at the top of the program.  It is much
  easier to remember <code>COMPUTER_WINS</code> than it is the arbitrary
  numeric value assigned to it.</li><li>A new function, <code>play_game()</code>, creates variables for
  <code>player_score</code> and <code>comp_score</code>.  Using a
  <code>while</code> loop, it repeatedly calls <code>play_round</code>,
  checking the result of each call and updating the score appropriately.
  Finally, when either the player or computer reach 5 points,
  <code>play_game</code> returns the winner to the main body of the program,
  which then displays the winner and then quits.</li><li>There are two variables named <code>result</code>---one in the
  <code>play_game</code> function and one in the main body of the program.
  While they have the same name, they are in different <em>namespaces</em>,
  and bear no relation to each other.  Each function creates its own
  namespace, and names defined within the body of the function are not
  <q>visible</q> to code outside the function body.  Namespaces will be
  discussed in greater detail in the next chapter.</li></ul><h2>8.11 Glossary<a name="auto10"></a></h2><a name="index08"></a><a name="index09"></a><a name="index10"></a><a name="index11"></a><a name="index12"></a><a name="index13"></a><a name="index14"></a><a name="index15"></a><dl><dt>random:</dt><dd>Having no specific pattern. Unpredictable. Computers are designed to be
predicatable, and it is not possible to get a truly random value from
a computer.  Certain functions produce sequences of values that appear
as if they were random, and it is these <em>psuedorandom</em> values that
we get from Python.</dd><dt>trichotomy:</dt><dd>Given any real numbers <em>a</em> and <em>b</em>, exactly one of
the following relations holds:  <em>a &lt; b</em>, <em>a &gt; b</em>,
or <em>a = b</em>.  Thus when you can establish that two of the relations are
false, you can assume the remaining one is true.</dd><dt>nested loop:</dt><dd>A loop inside the body of another loop.</dd><dt>abstraction:</dt><dd><em>Generalization</em> by reducing the information content of a concept.
Functions in Python can be used to group a number of program statements with
a single name, abstracting out the details and making the program easier to
understand. 
</dd><dt>constant:</dt><dd>
A numerical value that does not change during the execution of a program.
It is conventional to use names with all uppercase letters to repesent
constants, though Python programs rely on the discipline of the programmers
to enforce this, since there is no language mechanism to to support true
constants in Python. 
</dd></dl><h2>8.12 Exercises<a name="auto11"></a></h2><ol><li><div class="exercise">
What happens when you press the &lt;Escape&gt; key while running
<code>mitt.py</code>? List the two lines from the program that produce this
behavior and explain how they work.
</div></li><li><div class="exercise">
What is the name of the counter variable in <code>guess.py</code>?  With
a proper strategy, the maximum number of guesses required to arrive at the
correct number should be 11.  What is this strategy?
</div></li><li><div class="exercise">
What happens when the <q>mitt</q> in <code>mitt.py</code> gets to the top or
bottom of the graphics window?  List the lines from the program that control
this behavior and explain <em>in detail</em> how they work.
</div></li><li><div class="exercise">
Change the value of <code>ball1_dx</code> in <code>collide.py</code> to 2.  How 
does the program behave differently?  Now change <code>ball1_dx</code> back to
4 and set <code>ball2_dx</code> to -2.  Explain <em>in detail</em> how these
changes effect the behavior of the program.
</div></li><li><div class="exercise">
Comment out (put a <code>#</code> in front of the statement) the
<code>break</code> statement in <code>collide.py</code>.  Do you notice any
change in the behavior of the program?  Now also comment out the 
<code>remove_from_screen(ball1)</code> statement.  What happens now?
Experiment with commenting and uncommenting the two
<code>remove_from_screen</code> statements and the <code>break</code> statement
until you can describe <em>specifically</em> how these statement work together
to produce the desired behavior in the program.
</div></li><li><div class="exercise">
Where can you add the lines
<pre class="python">
<span class="py-src-variable">Text</span>(<span class="py-src-string">&quot;Player Wins!&quot;</span>, (<span class="py-src-number">340</span>, <span class="py-src-number">290</span>), <span class="py-src-variable">size</span>=<span class="py-src-number">32</span>)
<span class="py-src-variable">sleep</span>(<span class="py-src-number">2</span>)
</pre>
to the version of <code>catch.py</code> in section 8.8 so that the program
displays this message when the ball is <q>caught</q>?
</div></li><li><div class="exercise">
Trace the flow of execution in the final version of <code>catch.py</code> when
you press the &lt;Escape&gt; during the execution of <code>play_round</code>.
What happens when you press this key?  Why?
</div></li><li><div class="exercise">
List the main body of the final version of <code>catch.py</code>.  Describe
<em>in detail</em> what each line of code does.  Which statement calls the
function that starts the game?
</div></li><li><div class="exercise">
Identify the function responsible for displaying the ball and the mitt.  What
other operations are provided by this function?
</div></li><li><div class="exercise">
Which function keeps track of the score?  Is this also the function that
displays the score?  Justify your answer by discussing specific parts of the
code which implement these operations.
</div></li></ol><h2>8.13 Project: <code>pong.py</code><a name="auto12"></a></h2><p><a href="http://en.wikipedia.org/wiki/Pong">Pong</a> was one of the first
commercial video games.  With a capital P it is a registered trademark, but
<q>pong</q> is used to refer any of the table tennis like paddle and ball video 
games.</p><p><code>catch.py</code> already contains all the programming tools we need
to develop our own version of pong.   Incrementally changing
<code>catch.py</code> into <code>pong.py</code> is the goal of this project,
which you will accomplish by completing the following series of exercises:</p><ol><li><div class="exercise">
Copy <code>catch.py</code> to <code>pong1.py</code> and change the ball into
a paddle by using <code>Box</code> instead of the <code>Circle</code>.  You can 
look at Appendix A for more information on <code>Box</code>.   Make the
adjustments needed to keep the paddle on the screen.
</div></li><li><div class="exercise">
Copy <code>pong1.py</code> to <code>pong2.py</code>.  Replace the
<code>distance</code> function with a boolean function
<code>hit(bx, by, r, px, py, h)</code> that returns <code>True</code> when
the vertical coordinate of the ball (<code>by</code>) is between the bottom
and top of the paddle, and the horizontal location of the ball
(<code>bx</code>) is less than or equal to the radius (<code>r</code>) away
from the front of the paddle.  Use <code>hit</code> to determine when the
ball hits the paddle, and make the ball bounce back in the opposite horizontal
direction when <code>hit</code> returns <code>True</code>.  Your completed
function should pass these doctests:
<pre class="python">
<span class="py-src-keyword">def</span> <span class="py-src-identifier">hit</span>(<span class="py-src-parameter">bx</span>, <span class="py-src-parameter">by</span>, <span class="py-src-parameter">r</span>, <span class="py-src-parameter">px</span>, <span class="py-src-parameter">py</span>, <span class="py-src-parameter">h</span>):
    <span class="py-src-string">&quot;&quot;&quot;
      &gt;&gt;&gt; hit(760, 100, 10, 780, 100, 100)
      False
      &gt;&gt;&gt; hit(770, 100, 10, 780, 100, 100)
      True
      &gt;&gt;&gt; hit(770, 200, 10, 780, 100, 100)
      True
      &gt;&gt;&gt; hit(770, 210, 10, 780, 100, 100)
      False
    &quot;&quot;&quot;</span>
</pre>
Finally, change the scoring logic to give the player a point when the ball goes 
off the screen on the left.
</div></li><li><div class="exercise">
Copy <code>pong2.py</code> to <code>pong3.py</code>.   Add a new paddle on
the left side of the screen which moves up when <code>'a'</code> is pressed
and down when <code>'s'</code> is pressed.  Change the starting point for the
ball to the center of the screen, (400, 300), and make it randomly move to
the left or right at the start of each round.
</div></li></ol></div><p><a href="index.xhtml">Table of Contents</a> |
    <a href="dex.html">Index</a></p></body></html>